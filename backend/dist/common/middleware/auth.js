"use strict";var h=Object.create;var c=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var R=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var D=(e,t)=>{for(var n in t)c(e,n,{get:t[n],enumerable:!0})},a=(e,t,n,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of v(t))!U.call(e,s)&&s!==n&&c(e,s,{get:()=>t[s],enumerable:!(u=m(t,s))||u.enumerable});return e};var l=(e,t,n)=>(n=e!=null?h(R(e)):{},a(t||!e||!e.__esModule?c(n,"default",{value:e,enumerable:!0}):n,e)),E=e=>a(c({},"__esModule",{value:!0}),e);var I={};D(I,{auth:()=>H});module.exports=E(I);var r=require("http-status-codes"),p=l(require("jsonwebtoken"));var d=l(require("dotenv")),o=require("envalid");d.default.config();var f=(0,o.cleanEnv)(process.env,{NODE_ENV:(0,o.str)({devDefault:(0,o.testOnly)("test"),choices:["development","production","test"]}),HOST:(0,o.host)({devDefault:(0,o.testOnly)("localhost")}),PORT:(0,o.port)({devDefault:(0,o.testOnly)(3e3)}),CORS_ORIGIN:(0,o.str)({devDefault:(0,o.testOnly)("http://localhost:3000")}),SECRET:(0,o.str)({devDefault:(0,o.testOnly)("")})});var T=["/auth","/health-check","/","/favicon.ico","/cp/"],O="/cp",N=(e,t,n)=>{let{SECRET:u}=f;if(T.includes(e.originalUrl)){n();return}if(e.originalUrl.includes(O)){n();return}let s=e.headers.authorization;if(!s)return t.status(r.StatusCodes.UNAUTHORIZED).send("Access Denied / Unauthorized request");try{if(s=s.split(" ")[1],!s)return t.status(r.StatusCodes.UNAUTHORIZED).send("Unauthorized request");let i=p.default.verify(s,u);if(!i)return t.status(r.StatusCodes.UNAUTHORIZED).send("Unauthorized request");e.locals||(e.locals={}),e.locals.user=i,n()}catch{return t.status(r.StatusCodes.BAD_REQUEST).send("Invalid Token")}},H=()=>[N];0&&(module.exports={auth});
